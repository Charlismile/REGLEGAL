@* @page "/RegComite" *@
@* @using BlazorBootstrap *@
@* <EditForm Model="@ComiteData" method="post" OnValidSubmit="CreateComiteSubmit" FormName="register"> *@
@*     <div class="card"> *@
@*         <div class="card-header bg-white"> *@
@*             <div class="row row-cols-lg-auto g-3 align-items-center"> *@
@*                 <div class="col-12"> *@
@*                     <h2 class="mb-0 fw-bold">Registro de Requisición</h2> *@
@*                 </div> *@
@*                 <div class="col-12 ms-auto"> *@
@*                     <NavLink class="btn btn-primary text-white" href="/" Match="NavLinkMatch.All"> *@
@*                         <i class="fa-solid fa-arrow-left me-1"></i> Volver *@
@*                     </NavLink> *@
@*                 </div> *@
@*             </div> *@
@*         </div> *@
@*         <div class="card-header"> *@
@*             <h3 class="mb-0 fw-bold">Datos Generales</h3> *@
@*         </div> *@
@*         <div class="card-body"> *@
@*             <DataAnnotationsValidator/> *@
@*             <ValidationSummary class="text-danger" role="alert"/> *@
@*             @if (!RequisicionResult.Success) *@
@*             { *@
@*                 <div class="mb-3"> *@
@*                     @foreach (var item in RequisicionResult.Errores) *@
@*                     { *@
@*                         <p class="text-danger mb-0">@item</p> *@
@*                     } *@
@*                 </div> *@
@*             } *@
@*             <div class="row"> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Region de Salud</label> *@
@*                         <InputText @bind-Value="@ComiteData.NombreRegion" *@
@*                                    class="form-control form-control-sm text-uppercase" *@
@*                                    disabled/> *@
@*                     </div> *@
@*                 </div> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Comunidad</label> *@
@*                         <InputText @bind-Value="@ComiteData.Comunidad" *@
@*                                    class="form-control form-control-sm text-uppercase" *@
@*                                    disabled/> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@
@*             <div class="row"> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Nombre y Título del Funcionario Responsable</label> *@
@*                         <InputSelect class="form-select form-select-sm" *@
@*                                      @bind-Value="@ComiteData.CreadaPor"> *@
@*                             <option value="">-- Seleccione --</option> *@
@*                             $1$ @foreach (var item in Directores) #1# *@
@*                             { *@
@*                                 $1$ <option value="@item.Id">@item.Name</option> #1# *@
@*                             } *@
@*                         </InputSelect> *@
@*                         <ValidationMessage For="() => ComiteData.CreadaPor" class="text-danger"/> *@
@*                     </div> *@
@*                 </div> *@
@*                 $1$ <div class="col-lg-6 col-md-6 col-sm-12"> #1# *@
@*                 $1$     <div class="mb-3"> #1# *@
@*                 $1$         <label class="fw-bold">Tiempo de Entrega</label> #1# *@
@*                 $1$         <InputText @bind-Value="ComiteData.TiempoEntrega" #1# *@
@*                 $1$                    class="form-control form-control-sm text-uppercase" aria-required="true"/> #1# *@
@*                 $1$         <ValidationMessage For="() => ComiteData.TiempoEntrega" class="text-danger"/> #1# *@
@*                 $1$     </div> #1# *@
@*                 $1$ </div> #1# *@
@*             </div> *@
@*             <div class="row"> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Nombre del Proyecto</label> *@
@*                         <InputText @bind-Value="ComiteData.NombreComiteSalud" *@
@*                                    class="form-control form-control-sm text-uppercase" *@
@*                                    aria-required="true"/> *@
@*                         <ValidationMessage For="() => ComiteData.NombreComiteSalud" class="text-danger"/> *@
@*                     </div> *@
@*                 </div> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Fecha de CREACION DEL COMITE</label> *@
@*                         <InputText type="date" @bind-Value="ComiteData.CreadaEn" *@
@*                                    class="form-control form-control-sm text-uppercase" aria-required="true"/> *@
@*                         <ValidationMessage For="() => ComiteData.CreadaEn" class="text-danger"/> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@
@*             <div class="row"> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Tipo de Tramite</label> *@
@*                         <InputSelect class="form-select form-select-sm" Value="@ComiteData.TramiteId" *@
@*                                      ValueChanged="@(async (string Value) => await RequisicionChanged(Value))" *@
@*                                      ValueExpression="@(() => ComiteData.TramiteId)"> *@
@*                             <option value="">-- Seleccione --</option> *@
@*                             $1$ @foreach (var item in NombreTramite) #1# *@
@*                             $1$ { #1# *@
@*                             $1$     <option value="@item.Code">@item.Name</option> #1# *@
@*                             $1$ } #1# *@
@*                         </InputSelect> *@
@*                         <ValidationMessage For="() => ComiteData.TramiteId" class="text-danger"/> *@
@*                     </div> *@
@*                 </div> *@
@*                 <div class="col-lg-6 col-md-6 col-sm-12"> *@
@*                     <div class="mb-3"> *@
@*                         <label class="fw-bold">Categoría de Proyecto</label> *@
@*                         <InputSelect class="form-select form-select-sm" @bind-Value="@ComiteData.NombreTramite"> *@
@*                             <option value="">-- Seleccione --</option> *@
@*                             $1$ @foreach (var item in Categorias) #1# *@
@*                             $1$ { #1# *@
@*                             $1$     <option value="@item.Id">@item.Name</option> #1# *@
@*                             $1$ } #1# *@
@*                         </InputSelect> *@
@*                         <ValidationMessage For="() => ComiteData.NombreTramite" class="text-danger"/> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@
@*         $1$     <div class="row"> #1# *@
@*         $1$         <div class="col-lg-6 col-md-6 col-sm-12"> #1# *@
@*         $1$             <div class="mb-3"> #1# *@
@*         $1$                 <label class="fw-bold">Clase de Proyecto</label> #1# *@
@*         $1$                 <InputSelect class="form-select form-select-sm" @bind-Value="@ComiteData.ClaseProyecto"> #1# *@
@*         $1$                     <option value="">-- Seleccione --</option> #1# *@
@*         $1$                     @foreach (var item in ClaseProyecto) #1# *@
@*         $1$                     { #1# *@
@*         $1$                         <option value="@item.Id">@item.Name</option> #1# *@
@*         $1$                     } #1# *@
@*         $1$                 </InputSelect> #1# *@
@*         $1$                 <ValidationMessage For="() => ComiteData.ClaseProyecto" class="text-danger"/> #1# *@
@*         $1$             </div> #1# *@
@*         $1$         </div> #1# *@
@*         $1$         <div class="col-lg-6 col-md-6 col-sm-12"> #1# *@
@*         $1$             <div class="mb-3"> #1# *@
@*         $1$                 <label class="fw-bold">Entidad Financiera</label> #1# *@
@*         $1$                 <InputSelect class="form-select form-select-sm" #1# *@
@*         $1$                              @bind-Value="@ComiteData.EntidadFinanciera"> #1# *@
@*         $1$                     <option value="">-- Seleccione --</option> #1# *@
@*         $1$                     @foreach (var item in EntidadesFinancieras) #1# *@
@*         $1$                     { #1# *@
@*         $1$                         <option value="@item.Id">@item.Name</option> #1# *@
@*         $1$                     } #1# *@
@*         $1$                 </InputSelect> #1# *@
@*         $1$                 <ValidationMessage For="() => ComiteData.EntidadFinanciera" class="text-danger"/> #1# *@
@*         $1$             </div> #1# *@
@*         $1$         </div> #1# *@
@*         $1$     </div> #1# *@
@*         $1$     <div class="row"> #1# *@
@*         $1$         <div class="col-lg-6 col-md-6 col-sm-12"> #1# *@
@*         $1$             <div class="mb-3"> #1# *@
@*         $1$                 <label class="fw-bold">Lugar de Entrega</label> #1# *@
@*         $1$                 <InputSelect class="form-select form-select-sm" @bind-Value="@ComiteData.LugarEntrega"> #1# *@
@*         $1$                     <option value="">-- Seleccione --</option> #1# *@
@*         $1$                     @foreach (var item in LugaresEntrega) #1# *@
@*         $1$                     { #1# *@
@*         $1$                         <option value="@item.Id">@item.Name</option> #1# *@
@*         $1$                     } #1# *@
@*         $1$                 </InputSelect> #1# *@
@*         $1$                 <ValidationMessage For="() => ComiteData.LugarEntrega" class="text-danger"/> #1# *@
@*         $1$             </div> #1# *@
@*         $1$         </div> #1# *@
@*         $1$         <div class="col-lg-6 col-md-6 col-sm-12"> #1# *@
@*         $1$             <div class="mb-3"> #1# *@
@*         $1$                 <label class="fw-bold">Tipo de Pago</label> #1# *@
@*         $1$                 <InputSelect class="form-select form-select-sm" @bind-Value="@ComiteData.TipoPago"> #1# *@
@*         $1$                     <option value="">-- Seleccione --</option> #1# *@
@*         $1$                     @foreach (var item in FormaPago) #1# *@
@*         $1$                     { #1# *@
@*         $1$                         <option value="@item.Id">@item.Name</option> #1# *@
@*         $1$                     } #1# *@
@*         $1$                 </InputSelect> #1# *@
@*         $1$                 <ValidationMessage For="() => ComiteData.TipoPago" class="text-danger"/> #1# *@
@*         $1$             </div> #1# *@
@*         $1$         </div> #1# *@
@*         $1$     </div> #1# *@
@*         $1$     <div class="mb-3"> #1# *@
@*         $1$         <label class="fw-bold">Observaciones del Proyecto</label> #1# *@
@*         $1$         <TextAreaInput @bind-Value="ComiteData.Observaciones" #1# *@
@*         $1$                        class="form-control form-control-sm text-uppercase" #1# *@
@*         $1$                        Rows="3"/> #1# *@
@*         $1$         <ValidationMessage For="() => ComiteData.Observaciones" class="text-danger"/> #1# *@
@*         $1$     </div> #1# *@
@*         $1$ </div> #1# *@
@*         $1$ <div class="card-header border-top"> #1# *@
@*         $1$     <h3 class="mb-0 fw-bold">Renglones de la Requisición</h3> #1# *@
@*         $1$ </div> #1# *@
@*         $1$ <div class="card-body"> #1# *@
@*         $1$     <div class="mb-3"> #1# *@
@*         $1$         <label class="fw-bold">Detalles del Grupo <span #1# *@
@*         $1$                 class="text-danger">(LEER TEXTO DE EJEMPLO)</span></label> #1# *@
@*         $1$         <TextAreaInput @bind-Value="ComiteData.GrupoBase" #1# *@
@*         $1$                        class="form-control form-control-sm text-uppercase" Rows="6" #1# *@
@*         $1$                        aria-required="true"/> #1# *@
@*         $1$         <ValidationMessage For="() => ComiteData.GrupoBase" class="text-danger"/> #1# *@
@*         $1$     </div> #1# *@
@*             @if (!ResultRenglon.Success) *@
@*             { *@
@*                 <div class="mb-3"> *@
@*                     @foreach (var item in ResultRenglon.Errores) *@
@*                     { *@
@*                         <p class="text-danger mb-0">@item</p> *@
@*                     } *@
@*                 </div> *@
@*             } *@
@*             <div class="row mb-2"> *@
@*                 <div class="col-lg-2"> *@
@*                     <label class="fw-bold">Cantidad</label> *@
@*                     <input type="number" @bind="RenglonForm.Cantidad" *@
@*                            class="form-control form-control-sm text-uppercase" *@
@*                            id="RowCantidad"> *@
@*                 </div> *@
@*                 $1$ <div class="col-lg-3"> #1# *@
@*                 $1$     <label class="fw-bold">Código</label> #1# *@
@*                 $1$     <div class="input-group"> #1# *@
@*                 $1$         <input #1# *@
@*                 $1$             id="RowCodigo" #1# *@
@*                 $1$             type="text" #1# *@
@*                 $1$             @bind="RenglonForm.Codigo" #1# *@
@*                 $1$             class="form-control form-control-sm text-uppercase"> #1# *@
@*                 $1$         @if (ComiteData.TipoRequisicionCode == "IS") #1# *@
@*                 $1$         { #1# *@
@*                 $1$             <button class="btn btn-sm btn-primary" type="button" @onclick="LoadFicha" #1# *@
@*                 $1$                     disabled="@(ComiteData.TipoRequisicionCode != "IS")"> #1# *@
@*                 $1$                 <Tooltip Title="Buscar Datos de la Ficha Técnica"> #1# *@
@*                 $1$                     <i class="fa-solid fa-magnifying-glass"></i> #1# *@
@*                 $1$                 </Tooltip> #1# *@
@*                 $1$             </button> #1# *@
@*                 $1$         } #1# *@
@*                 $1$     </div> #1# *@
@*                 $1$     @if (ComiteData.TipoRequisicionCode == "IS") #1# *@
@*                 $1$     { #1# *@
@*                 $1$         <div class="alert alert-info pb-0 mt-1" role="alert"> #1# *@
@*                 $1$             <p>Puede dar clic al botón para buscar los datos de la Ficha Técnica, cuando es Compra de #1# *@
@*                 $1$                 Insumos Sanitarios</p> #1# *@
@*                 $1$         </div> #1# *@
@*                 $1$     } #1# *@
@*                 $1$ </div> #1# *@
@*                 <div class="col-lg-3"> *@
@*                     <label class="fw-bold">Unidad</label> *@
@*                     <input type="text" @bind="RenglonForm.Unidad" class="form-control form-control-sm text-uppercase" *@
@*                            id="RowUnidad"> *@
@*                 </div> *@
@*                 <div class="col-lg-2"> *@
@*                     <label class="fw-bold">Precio Unitario</label> *@
@*                     <input type="number" @bind="RenglonForm.PrecioUnitario" *@
@*                            class="form-control form-control-sm text-uppercase" *@
@*                            id="RowPrecioUnitario"> *@
@*                 </div> *@
@*                 <div class="col-lg-2"> *@
@*                     <label class="fw-bold" for="RowITBMS">¿I.T.B.M.S.?</label> *@
@*                     <div> *@
@*                         <input type="checkbox" @bind="RenglonForm.ITBMS" class="form-check-input" id="RowITBMS"> *@
@*                         <label class="form-check-label" for="RowITBMS">I.T.B.M.S.</label> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@
@*             <div class="mb-2"> *@
@*                 <label class="fw-bold">Descripción</label> *@
@*                 <textarea id="RowDescripcion" @bind="RenglonForm.Descripcion" rows="6" *@
@*                           class="form-control form-control-sm text-uppercase text-uppercase"></textarea> *@
@*             </div> *@
@*         </div> *@
@*         <div class="card-footer border-bottom"> *@
@*             <button type="button" class="btn btn-primary text-white" @onclick="InsertItemSubmit"> *@
@*                 <i class="fa-solid fa-floppy-disk me-1"></i>Guardar Renglón *@
@*             </button> *@
@*             @if (RenglonEditing) *@
@*             { *@
@*                 <button type="button" class="btn btn-danger text-white ms-2" @onclick="CancelEditRenglon"> *@
@*                     <i class="fa-solid fa-xmark me-1"></i> Cancelar Edición *@
@*                 </button> *@
@*             } *@
@*         </div> *@
@*         <div class="card-body"> *@
@*             @if (Renglones == null || Renglones.Count == 0) *@
@*             { *@
@*                 <h3 class="fw-bold my-3"><i class="fa-regular fa-folder-open me-1"></i>Sin registros</h3> *@
@*             } *@
@*             else *@
@*             { *@
@*                 int row = 1; *@
@*                 <div class="table-responsive" style="max-height: 350px; overflow-y: auto;"> *@
@*                     <table class="table table-sm table-bordered"> *@
@*                         <thead> *@
@*                         <tr> *@
@*                             <th class="fw-bold text-center">#</th> *@
@*                             <th class="fw-bold text-center">Cantidad</th> *@
@*                             <th class="fw-bold text-center">Código</th> *@
@*                             <th class="fw-bold text-center">Unidad</th> *@
@*                             <th class="fw-bold text-center">Descripción</th> *@
@*                             <th class="fw-bold text-center">Precio Unitario</th> *@
@*                             <th class="fw-bold text-center">Sub Total</th> *@
@*                             <th class="fw-bold text-center">I.T.B.M.S.</th> *@
@*                             <th class="fw-bold text-center">Precio Total</th> *@
@*                             <th class="fw-bold text-center">Acciones</th> *@
@*                         </tr> *@
@*                         </thead> *@
@*                         <tbody> *@
@*                         @foreach (var item in Renglones.Where(x => x.ShowRow == true)) *@
@*                         { *@
@*                             <tr> *@
@*                                 <td class="text-center">@row</td> *@
@*                                 <td class="text-end">@item.Cantidad</td> *@
@*                                 <td>@item.Codigo</td> *@
@*                                 <td>@item.Unidad</td> *@
@*                                 <td class="" style="white-space: pre-wrap;">@item.Descripcion</td> *@
@*                                 <td class="text-end">@item.PrecioUnitario.ToString("#,##0.00##")</td> *@
@*                                 <td class="text-end">@item.ValorSubTotal.ToString("#,##0.00##")</td> *@
@*                                 <td class="text-center">@(item.ITBMS ? "SI" : "NO")</td> *@
@*                                 <td class="text-end">@item.ValorTotal.ToString("#,##0.00##")</td> *@
@*                                 <td class="text-center"> *@
@*                                     <div class="btn-group" role="group" aria-label="acciones"> *@
@*                                         <button type="button" class="btn btn-light" *@
@*                                                 @onclick="() => EditRenglon(item.TempId)"> *@
@*                                             <Tooltip Title="Editar Renglón"> *@
@*                                                 <i class="fa-solid fa-pen-to-square text-primary"></i> *@
@*                                             </Tooltip> *@
@*                                         </button> *@
@*                                         <button type="button" class="btn btn-light" *@
@*                                                 @onclick="() => DeleteRenglon(item.TempId)"> *@
@*                                             <Tooltip Title="Eliminar Renglón"> *@
@*                                                 <i class="fa-solid fa-trash text-danger"></i> *@
@*                                             </Tooltip> *@
@*                                         </button> *@
@*                                     </div> *@
@*                                 </td> *@
@*                             </tr> *@
@*                             row++; *@
@*                         } *@
@*                         </tbody> *@
@*                     </table> *@
@*                 </div> *@
@*             } *@
@*         </div> *@
@*         $1$ <div class="card-body border-top"> #1# *@
@*         $1$     <table class="table table-borderless ms-auto h4" style="width: min(300px, 100%);"> #1# *@
@*         $1$         <tr> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 SubTotal: #1# *@
@*         $1$             </td> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 @ComiteData.PrecioSubTotalRequisicion.ToString("n2") #1# *@
@*         $1$             </td> #1# *@
@*         $1$         </tr> #1# *@
@*         $1$         <tr> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 I.T.B.M.S.: #1# *@
@*         $1$             </td> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 @ComiteData.PrecioITBMSRequisicion.ToString("n2") #1# *@
@*         $1$             </td> #1# *@
@*         $1$         </tr> #1# *@
@*         $1$         <tr> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 Total: #1# *@
@*         $1$             </td> #1# *@
@*         $1$             <td class="text-end"> #1# *@
@*         $1$                 @ComiteData.PrecioTotalRequisicion.ToString("n2") #1# *@
@*         $1$             </td> #1# *@
@*         $1$         </tr> #1# *@
@*         $1$     </table> #1# *@
@*         $1$ </div> #1# *@
@*         $1$ <div class="card-footer"> #1# *@
@*         $1$     <button type="submit" class="btn btn-primary text-white"> #1# *@
@*         $1$         <i class="fa-solid fa-floppy-disk me-1"></i>Guardar Requisición #1# *@
@*         $1$     </button> #1# *@
@*         $1$ </div> #1# *@
@*     </div> *@
@* </EditForm> *@
@* *@
@* <Modal @ref="ModalFormulario" *@
@*        Title="!Mensaje¡" *@
@*        ShowCloseButton="false" *@
@*        UseStaticBackdrop="true" *@
@*        Size="ModalSize.Regular"> *@
@*     <BodyTemplate> *@
@*         @if (!RequisicionResult.Success) *@
@*         { *@
@*             <div class="mb-3"> *@
@*                 @foreach (var item in RequisicionResult.Errores) *@
@*                 { *@
@*                     <p class="text-danger mb-1 h4">@item</p> *@
@*                 } *@
@*             </div> *@
@*         } *@
@*     </BodyTemplate> *@
@*     <FooterTemplate> *@
@*         <button type="button" class="btn btn-primary text-white" *@
@*                 onclick="@(async () => await ModalFormulario.HideAsync())"> *@
@*             <i class="fa-solid fa-rectangle-xmark me-1"></i>Cerrar *@
@*         </button> *@
@*     </FooterTemplate> *@
@* </Modal> *@